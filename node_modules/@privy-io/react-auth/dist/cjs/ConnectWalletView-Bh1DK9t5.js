"use strict";var e=require("react/jsx-runtime"),n=require("@heroicons/react/24/outline"),t=require("@tanstack/react-virtual"),l=require("react"),i=require("react-device-detect"),a=require("styled-components"),o=require("./ModalHeader-C5O9gNUP.js"),r=require("@heroicons/react/24/outline/CheckIcon"),s=require("./copy-BiZ7dtqy.js"),c=require("./Link-BdtTp2J4.js"),d=require("./QrCode-CLd3Ytk7.js"),u=require("./EmailInputForm-Y-nHsEtF.js"),h=require("./context-BeSQM-Ma.js"),p=require("./useI18n-CnsBjm9v.js"),m=require("./useActiveWallet-vlXeDPzp.js"),g=require("./internal-context-BJv4f_bO.js"),w=require("./WalletCards-BfpeHH5n.js"),y=require("./prepareFundingModalData-DDf6xLze.js"),f=require("./Screen-BSwlHqPg.js");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var x=/*#__PURE__*/v(r);let b=a.styled.button`
  display: flex;
  align-items: center;
  gap: 0.5rem;

  &:hover {
    text-decoration: underline;
  }

  svg {
    width: 0.875rem;
    height: 0.875rem;
  }
`,C=a.styled.span`
  display: flex;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.875rem;
  color: var(--privy-color-foreground-2);
`,j=a.styled(x.default)`
  color: var(--privy-color-success);
`,_=a.styled(s.Copy)`
  color: var(--privy-color-foreground-3);
  opactiy: 0.5;
`;function W({children:n,iconOnly:t,value:i,hideCopyIcon:a,...o}){let[r,s]=l.useState(!1);/*#__PURE__*/return e.jsxs(b,{...o,onClick:()=>{navigator.clipboard.writeText(i||n).catch(console.error),s(!0),setTimeout((()=>s(!1)),1500)},children:[n," ",r?/*#__PURE__*/e.jsxs(C,{children:[/*#__PURE__*/e.jsx(j,{})," ",!t&&"Copied"]}):!a&&/*#__PURE__*/e.jsx(_,{})]})}const L={phantom:{mobile:{native:"phantom://",universal:"https://phantom.app/ul/"}},solflare:{mobile:{native:void 0,universal:"https://solflare.com/ul/v1/"}},metamask:{image_url:{sm:m.Metamask,md:m.Metamask}}};class T{static normalize(e){return e.replace(/[-_]wallet$/,"").replace(/[-_]extension$/,"").toLowerCase()}isEth(e){return e.chains.some((e=>e.includes("eip155:")))}isSol(e){return e.chains.some((e=>e.includes("solana:")))}inAllowList(e,n){if(!this.normalizedAllowList||0===this.normalizedAllowList.length||"listing"===n&&this.includeWalletConnect)return!0;let t=T.normalize(e);return this.normalizedAllowList.some((e=>t===T.normalize(e)))}inDenyList(e,n){return"listing"===n&&"rabby"===e||"agw"===T.normalize(e)}chainMatches(e){return"ethereum-only"===this.chainFilter?"ethereum"===e:"solana-only"!==this.chainFilter||"solana"===e}getAllowListKey(e,n,t,l){let i=T.normalize(e);for(let e of this.normalizedAllowList||[])if(i===T.normalize(e))return e;if("connector"===n){if(("injected"===t||"solana_adapter"===t)&&"ethereum"===l&&this.detectedEth)return"detected_ethereum_wallets";if(("injected"===t||"solana_adapter"===t)&&"solana"===l&&this.detectedSol)return"detected_solana_wallets"}if("listing"===n&&this.includeWalletConnect)return"wallet_connect"}connectorOk(e){return!!("null"!==e.connectorType&&"walletconnect_solana"!==e.walletBranding.id&&this.chainMatches(e.chainType)&&(this.inAllowList(e.walletClientType,"connector")||("injected"===e.connectorType||"solana_adapter"===e.connectorType)&&("ethereum"===e.chainType&&this.detectedEth||"solana"===e.chainType&&this.detectedSol)))}listingOk(e){if(e.slug.includes("coinbase"))return!1;if("ethereum-only"===this.chainFilter){if(!this.isEth(e))return!1}else if("solana-only"===this.chainFilter&&!this.isSol(e))return!1;return!(!this.inAllowList(e.slug,"listing")||this.inDenyList(e.slug,"listing"))}getWallets(e,n){let t=new Map,l=e=>{let n=t.get(e.id);if(n){n.chainType!==e.chainType&&(n.chainType="multi");let t=new Set(n.chains);e.chains.forEach((e=>t.add(e))),n.chains=Array.from(t),!n.icon&&e.icon&&(n.icon=e.icon),!n.url&&e.url&&(n.url=e.url),!n.listing&&e.listing&&(n.listing=e.listing),!n.allowListKey&&e.allowListKey&&(n.allowListKey=e.allowListKey)}else t.set(e.id,e)};e.filter((e=>this.connectorOk(e))).forEach((e=>{let n=T.normalize(e.walletClientType);l({id:n,label:e.walletBranding?.name??n,source:"connector",connector:e,chainType:e.chainType,icon:e.walletBranding?.icon,url:void 0,chains:["ethereum"===e.chainType?"eip155":"solana"],allowListKey:this.getAllowListKey(e.walletClientType,"connector",e.connectorType,e.chainType)})}));let i=e.find((e=>"wallet_connect_v2"===e.connectorType)),a=e.find((e=>"walletconnect_solana"===e.walletBranding.id));n.filter((e=>this.listingOk(e))).forEach((n=>{let t=[...n.chains].filter((e=>e.includes("eip155:")||e.includes("solana:")));if(e.some((e=>T.normalize(e.walletClientType)===T.normalize(n.slug)&&"ethereum"===e.chainType&&"null"!==e.connectorType))||i||n.mobile.native||n.mobile.universal||m.mobileWalletsConfig[n.slug]?.chainTypes.includes("ethereum")||(t=t.filter((e=>!e.includes("eip155:")))),e.some((e=>T.normalize(e.walletClientType)===T.normalize(n.slug)&&"solana"===e.chainType&&"null"!==e.connectorType))||a||n.mobile.native||n.mobile.universal||m.mobileWalletsConfig[n.slug]?.chainTypes.includes("solana")||(t=t.filter((e=>!e.includes("solana:")))),!t.length)return;let o=T.normalize(n.slug),r=L[n.slug],s=r?.image_url?.sm||n.image_url?.sm;t.some((e=>e.includes("eip155:")))&&l({id:o,label:n.name||o,source:"listing",listing:n,chainType:"ethereum",icon:s,url:n.homepage,chains:t,allowListKey:this.getAllowListKey(n.slug,"listing")}),t.some((e=>e.includes("solana:")))&&l({id:o,label:n.name||o,source:"listing",listing:n,chainType:"solana",icon:s,url:n.homepage,chains:t,allowListKey:this.getAllowListKey(n.slug,"listing")})})),this.includeWalletConnectQr&&i&&l({id:"wallet_connect_qr",label:"WalletConnect",source:"connector",connector:i,chainType:"ethereum",icon:y.WALLET_CONNECT_LOGO_DATA_URI,url:void 0,chains:["eip155"],allowListKey:"wallet_connect_qr"}),this.includeWalletConnectQrSolana&&a&&l({id:"wallet_connect_qr_solana",label:"WalletConnect",source:"connector",connector:a,chainType:"solana",icon:y.WALLET_CONNECT_LOGO_DATA_URI,url:void 0,chains:["solana"],allowListKey:"wallet_connect_qr_solana"});let o=Array.from(t.values());o.forEach((e=>{let n=L[e.listing?.slug||e.id];n?.image_url?.sm&&(e.icon=n.image_url.sm)}));let r=new Map;return this.normalizedAllowList?.forEach(((e,n)=>{r.set(T.normalize(e),n)})),{wallets:o.slice().sort(((e,n)=>{if(e.allowListKey&&n.allowListKey){let t=this.normalizedAllowList?.findIndex((n=>T.normalize(n)===T.normalize(e.allowListKey)))??-1,l=this.normalizedAllowList?.findIndex((e=>T.normalize(e)===T.normalize(n.allowListKey)))??-1;if(t!==l&&t>=0&&l>=0)return t-l}if(e.allowListKey&&!n.allowListKey)return-1;if(!e.allowListKey&&n.allowListKey)return 1;let t=T.normalize(e.id),l=T.normalize(n.id);"binance-defi"===t?t="binance":"universalprofiles"===t?t="universal_profile":"cryptocom-defi"===t?t="cryptocom":"bitkeep"===t&&(t="bitget_wallet"),"binance-defi"===l?l="binance":"universalprofiles"===l?l="universal_profile":"cryptocom-defi"===l?l="cryptocom":"bitkeep"===l&&(l="bitget_wallet");let i=r.has(t),a=r.has(l);return i&&a?r.get(t)-r.get(l):i?-1:a?1:"connector"===e.source&&"listing"===n.source?-1:"listing"===e.source&&"connector"===n.source?1:e.label.toLowerCase().localeCompare(n.label.toLowerCase())})),walletCount:o.length}}constructor(e,n){this.chainFilter=e,n&&n.length>0&&(this.normalizedAllowList=n.map(String),this.normalizedAllowList.includes("binance")&&this.normalizedAllowList.push("binance-defi-wallet"),this.normalizedAllowList.includes("bitget_wallet")&&this.normalizedAllowList.push("bitkeep")),this.detectedEth=this.normalizedAllowList?.includes("detected_ethereum_wallets")??!1,this.detectedSol=this.normalizedAllowList?.includes("detected_solana_wallets")??!1,this.includeWalletConnect=this.normalizedAllowList?.includes("wallet_connect")??!1,this.includeWalletConnectQr=this.normalizedAllowList?.includes("wallet_connect_qr")??!1,this.includeWalletConnectQrSolana=this.normalizedAllowList?.includes("wallet_connect_qr_solana")??!1}}var k=n=>/*#__PURE__*/e.jsxs("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...n,children:[/*#__PURE__*/e.jsx("path",{d:"m0 0h32v32h-32z",fill:"#5469d4"}),/*#__PURE__*/e.jsx("path",{d:"m15.997 5.333-.143.486v14.106l.143.143 6.548-3.87z",fill:"#c2ccf4"}),/*#__PURE__*/e.jsx("path",{d:"m15.996 5.333-6.548 10.865 6.548 3.87z",fill:"#fff"}),/*#__PURE__*/e.jsx("path",{d:"m15.997 21.306-.08.098v5.025l.08.236 6.552-9.227z",fill:"#c2ccf4"}),/*#__PURE__*/e.jsx("path",{d:"m15.996 26.665v-5.36l-6.548-3.867z",fill:"#fff"}),/*#__PURE__*/e.jsx("path",{d:"m15.995 20.07 6.548-3.87-6.548-2.976v6.847z",fill:"#8698e8"}),/*#__PURE__*/e.jsx("path",{d:"m9.448 16.2 6.548 3.87v-6.846z",fill:"#c2ccf4"})]}),S=n=>/*#__PURE__*/e.jsxs("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...n,children:[/*#__PURE__*/e.jsxs("linearGradient",{id:"a",gradientUnits:"userSpaceOnUse",x1:"7.233",x2:"24.766",y1:"24.766",y2:"7.234",children:[/*#__PURE__*/e.jsx("stop",{offset:"0",stopColor:"#9945ff"}),/*#__PURE__*/e.jsx("stop",{offset:".2",stopColor:"#7962e7"}),/*#__PURE__*/e.jsx("stop",{offset:"1",stopColor:"#00d18c"})]}),/*#__PURE__*/e.jsx("path",{d:"m0 0h32v32h-32z",fill:"#10111a"}),/*#__PURE__*/e.jsx("path",{clipRule:"evenodd",d:"m9.873 20.41a.645.645 0 0 1 .476-.21l14.662.012a.323.323 0 0 1 .238.54l-3.123 3.438a.643.643 0 0 1 -.475.21l-14.662-.012a.323.323 0 0 1 -.238-.54zm15.376-2.862a.322.322 0 0 1 -.238.54l-14.662.012a.642.642 0 0 1 -.476-.21l-3.122-3.44a.323.323 0 0 1 .238-.54l14.662-.012a.644.644 0 0 1 .475.21zm-15.376-9.738a.644.644 0 0 1 .476-.21l14.662.012a.322.322 0 0 1 .238.54l-3.123 3.438a.643.643 0 0 1 -.475.21l-14.662-.012a.323.323 0 0 1 -.238-.54z",fill:"url(#a)",fillRule:"evenodd"})]});const z=a.styled.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
`,A=a.styled.button`
  padding: 0.25rem;
  height: 30px;
  width: 30px;

  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--privy-border-radius-full);
  background: var(--privy-color-background-2);
`,E=a.styled.div`
  position: relative;
  display: inline-flex;
  align-items: center;

  &::after {
    content: ' ';
    border-radius: var(--privy-border-radius-full);
    height: 6px;
    width: 6px;
    background-color: var(--privy-color-icon-success);
    position: absolute;
    right: -3px;
    top: -3px;
  }
`,q=a.styled.img`
  width: 32px;
  height: 32px;
  border-radius: 0.25rem;
  object-fit: contain;
`,I=a.styled.span`
  display: flex;
  gap: 0.25rem;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 500;
  line-height: 1.125rem; /* 150% */
  border-radius: var(--privy-border-radius-sm);
  background-color: var(--privy-color-background-2);

  svg {
    width: 100%;
    max-width: 1rem;
    max-height: 1rem;
    stroke-width: 2;
  }
`,M=a.styled.div`
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  max-height: 24rem;
  overflow-y: scroll;

  &::-webkit-scrollbar {
    display: none;
  }

  scrollbar-gutter: stable both-edges;
  scrollbar-width: none;
  -ms-overflow-style: none;

  ${e=>"light"===e.$colorScheme?"background: linear-gradient(var(--privy-color-background), var(--privy-color-background) 70%) bottom, linear-gradient(rgba(0, 0, 0, 0) 20%, rgba(0, 0, 0, 0.06)) bottom;":"dark"===e.$colorScheme?"background: linear-gradient(var(--privy-color-background), var(--privy-color-background) 70%) bottom, linear-gradient(rgba(255, 255, 255, 0) 20%, rgba(255, 255, 255, 0.06)) bottom;":void 0}

  background-repeat: no-repeat;
  background-size:
    100% 32px,
    100% 16px;
  background-attachment: local, scroll;
`;function N({enabled:e=!0,walletList:n,walletChainType:t}){let i=h.useAppConfig(),{connectors:a}=g.usePrivyInternal(),{listings:o,loading:r}=m.useExternalWalletListings(e),s=t??i.appearance.walletChainType,c=n??i.appearance?.walletList,d=l.useMemo((()=>new T(s,c)),[s,c]),{wallets:u,walletCount:p}=l.useMemo((()=>d.getWallets(a,o)),[d,a,o]),[w,y]=l.useState(""),f=l.useMemo((()=>w?u.filter((e=>e.label.toLowerCase().includes(w.toLowerCase()))):u),[w,u]),[v,x]=l.useState();return{selected:v,setSelected:x,search:w,setSearch:y,loadingListings:r,wallets:f,walletCount:p}}let B=e=>!e||"string"!=typeof e&&(e instanceof m.EthereumNullConnector||e instanceof m.SolanaNullConnector);const O=({index:n,style:t,data:l,recent:i})=>{let a=l.wallets[n],{walletChainType:o,handleWalletClick:r}=l,{t:s}=p.useI18n(),c={...t,boxSizing:"border-box"};return a?/*#__PURE__*/e.jsxs(U,{style:c,onClick:()=>r(a),children:[a.icon&&(a.connector&&!B(a.connector)?/*#__PURE__*/e.jsx(E,{children:"string"==typeof a.icon?/*#__PURE__*/e.jsx(q,{src:a.icon}):/*#__PURE__*/e.jsx(a.icon,{style:{width:"32px",height:"32px"}})}):"string"==typeof a.icon?/*#__PURE__*/e.jsx(q,{src:a.icon}):/*#__PURE__*/e.jsx(a.icon,{style:{width:"32px",height:"32px"}})),/*#__PURE__*/e.jsx(D,{children:a.label}),i?/*#__PURE__*/e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsx(I,{children:s("connectWallet.lastUsed")}),/*#__PURE__*/e.jsx(P,{children:/*#__PURE__*/e.jsxs(e.Fragment,{children:["ethereum-only"===o&&/*#__PURE__*/e.jsx(k,{}),"solana-only"===o&&/*#__PURE__*/e.jsx(S,{})]})})]}):/*#__PURE__*/e.jsx(P,{children:!("ethereum-only"===o||"solana-only"===o)&&/*#__PURE__*/e.jsxs(e.Fragment,{children:[a.chains?.some((e=>e.startsWith("eip155")))&&/*#__PURE__*/e.jsx(k,{}),a.chains?.some((e=>e.startsWith("solana")))&&/*#__PURE__*/e.jsx(S,{})]})})]}):null};let K=a.styled.div`
  position: sticky;
  // Offset by negative margin to account for focus outline
  margin-top: -3px;
  padding-top: 3px;
  top: -3px;
  z-index: 1;
  background: var(--privy-color-background);
  padding-bottom: calc(var(--screen-space) / 2);
`,F=a.styled.div`
  display: flex;
  flex-direction: column;
  gap: ${5}px;
`,U=a.styled.button`
  && {
    gap: 0.5rem;
    align-items: center;
    display: flex;
    position: relative;
    text-align: left;
    font-weight: 500;
    transition: background 200ms ease-in;
    width: calc(100% - 4px);
    border-radius: var(--privy-border-radius-md);
    padding: 0.75em;
    border: 1px solid var(--privy-color-foreground-4);
    justify-content: space-between;
  }

  &:hover {
    background: var(--privy-color-background-2);
  }
`,P=a.styled.span`
  display: flex;
  align-items: center;
  justify-content: end;
  position: relative;

  & > svg {
    border-radius: var(--privy-border-radius-full);
    stroke-width: 2.5;
    width: 100%;
    max-height: 1rem;
    max-width: 1rem;
    flex-shrink: 0;
  }

  & > svg:not(:last-child) {
    border-radius: var(--privy-border-radius-full);
    margin-right: -0.375rem;
  }
`,R=a.styled.div`
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
`,D=a.styled.span`
  text-overflow: ellipsis;
  white-space: nowrap;
  color: var(--privy-color-foreground);
  font-weight: 400;
  flex: 1;
`,$=a.styled(W)`
  && {
    margin: 0.5rem auto 0 auto;
  }
`,Q=a.styled.div`
  text-align: center;
  margin-top: 1rem;
  font-size: 0.875rem;
  font-weight: 400;
  color: var(--privy-color-foreground-3);
`;exports.Chip=I,exports.CloseButton=A,exports.CopyableText=W,exports.Header=z,exports.ScrollContainer=M,exports.WalletFilterer=T,exports.WalletIcon=q,exports.WalletRow=O,exports.i=({className:a,customDescription:r,connectOnly:s,preSelectedWalletId:v,hideHeader:x,...b})=>{let C=h.useAppConfig(),{t:j}=p.useI18n(),{connectors:_}=g.usePrivyInternal(),W=b.walletChainType||C.appearance.walletChainType,z=b.walletList||C.appearance?.walletList,{onBack:A,onClose:E,app:I}=b,{selected:M,setSelected:H,qrUrl:V,setQrUrl:G,connecting:Y,uiState:J,errorCode:X,wallets:Z,walletCount:ee,handleConnect:ne,handleBack:te,showSearchBar:le,isInitialConnectView:ie,title:ae,search:oe,setSearch:re}=function({onConnect:e,onBack:n,onClose:t,onConnectError:a,walletList:o,walletChainType:r,app:s}){let c=h.useAppConfig(),{connectors:d}=g.usePrivyInternal(),{t:u}=p.useI18n(),{wallets:w,walletCount:y,search:f,setSearch:v,selected:x,setSelected:b}=N({enabled:m.shouldFetchWcRegistryListings(o??[]),walletList:o,walletChainType:r}),[C,j]=l.useState(),[_,W]=l.useState(),[L,T]=l.useState(),[k,S]=l.useState(),z=!x&&!L&&!k,A=z&&(y>6||f.length>0),E=d.find((e=>"wallet_connect_v2"===e.connectorType)),q=l.useCallback((async(n,t)=>{if(n){if(k?.connector===n&&"loading"===C)return void console.log("Already connecting to this wallet, skipping duplicate attempt");if(j("loading"),"string"==typeof n)return S({connector:n,name:t?.name??"Wallet",icon:t?.icon,id:t?.id,url:t?.url}),void window.open(n,"_blank");S({connector:n,name:t?.name??n.walletBranding.name??"Wallet",icon:t?.icon??n.walletBranding.icon,id:t?.id,url:t?.url});try{let t=await n.connect({showPrompt:!0});if(!t)return j("error"),W(void 0),void a?.(new g.PrivyConnectorError("Unable to connect wallet"));j("success"),W(void 0),m.setActiveWallet({address:t.address,client:t.walletClientType,appId:c.id}),setTimeout((()=>{e({connector:n,wallet:t})}),h.DEFAULT_SUCCESS_SCREEN_DURATION_MS)}catch(n){if(console.error("ERROR: ",{e:n}),n?.message?.includes("already pending for origin")||n?.message?.includes("wallet_requestPermissions"))return void console.log("Connection request already pending, maintaining loading state");j("error"),W(n?.privyErrorCode),a?.(n instanceof Error?n:new g.PrivyConnectorError(n?.message||"Unable to connect wallet"))}}}),[c.id,e,k,C]),I=l.useCallback((()=>L?(j(void 0),W(void 0),S(void 0),void T(void 0)):k?(j(void 0),W(void 0),void S(void 0)):x?(j(void 0),W(void 0),S(void 0),void b(void 0)):"error"===C||"loading"===C?(j(void 0),W(void 0),void S(void 0)):void n?.()),[L,k,x,C,n]),M=l.useMemo((()=>k?.connector===E&&L&&i.isMobile&&k?.name?u("connectWallet.goToWallet",{walletName:k.name}):k?.connector===E&&L&&k?.name?u("connectWallet.scanToConnect",{walletName:k.name}):L&&k?.name?i.isMobile?u("connectWallet.goToWallet",{walletName:k.name}):u("connectWallet.scanToConnect",{walletName:k.name}):"string"==typeof k?.connector?u("connectWallet.openOrInstall",{walletName:k.name}):x&&!k?u("connectWallet.selectNetwork"):k?null:u("connectWallet.selectYourWallet")),[k,L,x,E,u]);return{selected:x,setSelected:b,qrUrl:L,setQrUrl:T,connecting:k,uiState:C,errorCode:_,search:f,setSearch:v,wallets:w,walletCount:y,wc:E,isInitialConnectView:z,showSearchBar:A,title:M,handleConnect:q,handleBack:I,onClose:t,onConnect:e,app:s}}({...b,walletList:z,walletChainType:W}),se=_.find((e=>"wallet_connect_v2"===e.connectorType)),ce=_.find((e=>"walletconnect_solana"===e.walletBranding.id)),de=l.useRef(null),ue=t.useVirtualizer({count:Z.length,getScrollElement:()=>de.current,estimateSize:()=>56,overscan:6,gap:5}),he=l.useCallback((async e=>{let n="solana-only"!==W&&e.chains?.some((e=>e.startsWith("eip155"))),t="ethereum-only"!==W&&e.chains?.some((e=>e.startsWith("solana"))),l=()=>{let n=e.id;return m.mobileWalletsConfig[n]||m.mobileWalletsConfig[`${n}_wallet`]},a=n=>{let t=T.normalize(e.id);return _.find((e=>T.normalize(e.walletClientType)===t&&e.chainType===n&&!("ethereum"===e.chainType&&e instanceof m.EthereumNullConnector||"solana"===e.chainType&&e instanceof m.SolanaNullConnector)))},o=async()=>{if(!se||!e.listing)return!1;let n=L[e.listing.slug]?{...e.listing,...L[e.listing.slug]}:e.listing;return se.setWalletEntry(n,G),await se.resetConnection(e.id),await ne(se,{name:e.label,icon:e.icon,id:e.id,url:e.url}),!0},r=async()=>!!ce&&!!e.listing&&(await ce.disconnect(),ce.wallet.setWalletEntry(e.listing,G),await new Promise((e=>setTimeout(e,100))),await ne(ce,{name:e.label,icon:e.icon,id:e.id,url:e.url}),!0),c=async n=>{let t=(e=>{let n=l();if(n)return n.getMobileRedirect({isSolana:e,connectOnly:!!s,useUniversalLink:!1})})(n);return!!t&&(await ne(t,{name:e.label,icon:e.icon,id:e.id,url:e.url}),!0)};if(n&&t)H(e);else{if(n&&!t){let n=a("ethereum");if(n&&!B(n))return void await ne(n,{name:e.label,icon:e.icon,id:e.id,url:e.url});if(i.isMobile&&l()){if(await c(!1)||await o())return}else if(await o()||await c(!1))return}if(t&&!n){let n=a("solana");if(n&&!B(n))return void await ne(n,{name:e.label,icon:e.icon,id:e.id,url:e.url});if(i.isMobile){if(await c(!0)||await r())return}else if(await r()||await c(!0))return}if(!B(e.connector)){if(se&&"wallet_connect_v2"===e.connector?.connectorType)if(await se.resetConnection(e.id),"wallet_connect_qr"!==e.id&&e.listing){let n=L[e.listing.slug]?{...e.listing,...L[e.listing.slug]}:e.listing;se.setWalletEntry(n,G)}else se.setWalletEntry({id:"wallet_connect_qr",name:"WalletConnect",rdns:"",slug:"wallet-connect",homepage:"",chains:["eip155"],mobile:{native:"",universal:void 0}},G);return ce&&"walletconnect_solana"===e.connector?.walletBranding.id&&(await ce.disconnect(),"wallet_connect_qr_solana"!==e.id&&e.listing?ce.wallet.setWalletEntry(e.listing,G):ce.wallet.setWalletEntry({id:"wallet_connect_solana_qr",name:"WalletConnect",rdns:"",slug:"wallet-connect-solana",homepage:"",chains:["solana"],mobile:{native:"",universal:void 0}},G),await new Promise((e=>setTimeout(e,100)))),void await ne(e.connector,{name:e.label,icon:e.icon,id:e.id,url:e.url})}e.url&&await ne(e.url,{name:e.label,icon:e.icon,id:e.id,url:e.url})}}),[se,ce,ne,H,G,W,s,_]);return l.useEffect((()=>{if(!v)return;let e=Z.find((({id:e})=>e===v));e&&he(e).catch(console.error)}),[v]),/*#__PURE__*/e.jsxs(f.Screen,{className:a,children:[/*#__PURE__*/e.jsx(f.Screen.Header,{icon:x&&ie?void 0:Y&&!V||V&&i.isMobile&&Y?.icon?Y.icon:Y?void 0:w.WalletCards,iconVariant:Y&&!V||V&&i.isMobile?"loading":void 0,iconLoadingStatus:Y&&!V||V&&i.isMobile?{success:"success"===J,fail:"error"===J}:void 0,title:x&&ie?void 0:Y&&!V?j("connectWallet.waitingForWallet",{walletName:Y.name}):V&&i.isMobile?j("connectWallet.waitingForWallet",{walletName:Y?.name??"connection"}):ae,subtitle:x&&ie?void 0:Y&&!V&&"string"==typeof Y.connector?j("connectWallet.installAndConnect",{walletName:Y.name}):Y&&!V&&"string"!=typeof Y.connector?"error"===J?X===g.PrivyErrorCode.NO_SOLANA_ACCOUNTS?`The connected wallet has no Solana accounts. Please add a Solana account in ${Y.name} and try again.`:j("connectWallet.tryConnectingAgain"):j("connectionStatus.connectOneWallet"):ie?r??(I?j("connectWallet.connectToAccount",{appName:I.name}):null):null,showBack:!!A||!ie,showClose:!0,onBack:A||te,onClose:E}),/*#__PURE__*/e.jsxs(f.Screen.Body,{ref:de,$colorScheme:C.appearance.palette.colorScheme,style:{marginBottom:V?"0.5rem":void 0},children:[le&&/*#__PURE__*/e.jsx(K,{children:/*#__PURE__*/e.jsxs(u.EmailUpdateForm,{style:{background:"transparent"},children:[/*#__PURE__*/e.jsx(m.LoginMethodIconWrapper,{children:/*#__PURE__*/e.jsx(n.MagnifyingGlassIcon,{})}),/*#__PURE__*/e.jsx("input",{className:"login-method-button",type:"text",placeholder:j("connectWallet.searchPlaceholder",{count:String(ee)}),onChange:e=>re(e.target.value),value:oe})]})}),V&&i.isMobile&&"loading"===J&&/*#__PURE__*/e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem"},children:[/*#__PURE__*/e.jsx(o.Button,{variant:"primary",onClick:()=>window.open(V.universal??V.native,"_blank"),style:{width:"100%"},children:j("connectWallet.openInApp")}),/*#__PURE__*/e.jsx($,{value:V.universal??V.native,iconOnly:!0,children:"Copy link"})]}),V&&!i.isMobile&&"loading"===J&&/*#__PURE__*/e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem"},children:/*#__PURE__*/e.jsx($,{value:V.universal??V.native,iconOnly:!0,children:j("connectWallet.copyLink")})}),V&&!i.isMobile&&/*#__PURE__*/e.jsx(d.QrCode,{size:280,url:V.universal??V.native,squareLogoElement:Y?.icon?"string"==typeof Y.icon?n=>/*#__PURE__*/e.jsx("svg",{...n,children:/*#__PURE__*/e.jsx("image",{href:Y.icon,height:n.height,width:n.width})}):Y.icon:y.WalletConnect}),V&&!i.isMobile&&Y?.url&&("binance"===Y.id||"binanceus"===Y.id||"binance-defi"===Y.id)&&/*#__PURE__*/e.jsxs(Q,{children:[/*#__PURE__*/e.jsxs("span",{children:["Don't have ",Y.name,"? "]}),/*#__PURE__*/e.jsx(c.Link,{href:Y.url,target:"_blank",size:"sm",children:"Download here"})]}),/*#__PURE__*/e.jsxs(F,{children:[Y&&!V&&"string"==typeof Y.connector&&/*#__PURE__*/e.jsxs(U,{onClick:()=>window.open(Y.connector,"_blank"),children:[Y.icon&&("string"==typeof Y.icon?/*#__PURE__*/e.jsx(q,{src:Y.icon}):/*#__PURE__*/e.jsx(Y.icon,{})),/*#__PURE__*/e.jsx(D,{children:Y.name})]}),M?.chains.some((e=>e.startsWith("eip155")))&&!Y&&/*#__PURE__*/e.jsxs(U,{onClick:()=>he({...M,chains:M.chains.filter((e=>e.startsWith("eip155")))}),children:[M.icon&&("string"==typeof M.icon?/*#__PURE__*/e.jsx(q,{src:M.icon}):/*#__PURE__*/e.jsx(M.icon,{})),/*#__PURE__*/e.jsx(D,{children:M.label}),/*#__PURE__*/e.jsx(P,{children:/*#__PURE__*/e.jsx(k,{})})]}),M?.chains.some((e=>e.startsWith("solana")))&&!Y&&/*#__PURE__*/e.jsxs(U,{onClick:()=>he({...M,chains:M.chains.filter((e=>e.startsWith("solana")))}),children:[M.icon&&("string"==typeof M.icon?/*#__PURE__*/e.jsx(q,{src:M.icon}):/*#__PURE__*/e.jsx(M.icon,{})),/*#__PURE__*/e.jsx(D,{children:M.label}),/*#__PURE__*/e.jsx(P,{children:/*#__PURE__*/e.jsx(S,{})})]}),ie&&/*#__PURE__*/e.jsxs(e.Fragment,{children:[!(ee>0)&&/*#__PURE__*/e.jsx(R,{children:j("connectWallet.noWalletsFound")}),ee>0&&!V&&/*#__PURE__*/e.jsx("div",{style:{maxHeight:56*Math.min(Z.length,5)+5,width:"100%"},children:/*#__PURE__*/e.jsx("div",{style:{height:`${ue.getTotalSize()}px`,width:"100%",position:"relative"},children:ue.getVirtualItems().map((n=>/*#__PURE__*/e.jsx(O,{index:n.index,style:{position:"absolute",top:0,left:0,height:`${n.size}px`,transform:`translateY(${n.start}px)`},data:{wallets:Z,walletChainType:W,handleWalletClick:he}},n.key)))})})]})]})]}),/*#__PURE__*/e.jsxs(f.Screen.Footer,{children:[Y&&!V&&"string"!=typeof Y.connector&&"error"===J&&/*#__PURE__*/e.jsx(f.Screen.Actions,{children:/*#__PURE__*/e.jsx(o.Button,{style:{width:"100%",alignItems:"center"},variant:"error",onClick:()=>ne(Y.connector,{name:Y.name,icon:Y.icon,id:Y.id,url:Y.url}),children:j("connectWallet.retry")})}),!!(I&&I.legal.privacyPolicyUrl&&I.legal.termsAndConditionsUrl)&&/*#__PURE__*/e.jsx(o.TermsAndConditions,{app:I,alwaysShowImplicitConsent:!0}),/*#__PURE__*/e.jsx(f.Screen.Watermark,{})]})]})},exports.useWalletsListController=N;
