"use strict";var e=require("react/jsx-runtime"),r=require("react"),i=require("./context-BeSQM-Ma.js"),t=require("./get-is-unified-wallet-BwdzQwn_.js"),o=require("./index-CzmnSRoa.js"),u=require("./to-ui-error-C4aac_aM.js");require("@privy-io/js-sdk-core"),require("tinycolor2"),require("viem"),require("./internal-context-BJv4f_bO.js"),require("ofetch"),require("uuid"),require("jose"),require("eventemitter3"),require("./useActiveWallet-vlXeDPzp.js"),require("zustand"),require("styled-components"),require("react-device-detect"),require("./prepareFundingModalData-DDf6xLze.js"),require("./events-context-Di6--rDg.js"),require("viem/utils"),require("./getPublicClient-BsmZyCGX.js"),require("./useWallets-DMyuB5aJ.js"),require("@coinbase/wallet-sdk"),require("@privy-io/ethereum"),require("mipd"),require("@privy-io/popup"),require("./paths-DizMb-lU.js"),require("./usePrivy-Bx2PKTrU.js"),require("@scure/base"),require("@headlessui/react"),require("@walletconnect/ethereum-provider"),require("@privy-io/urls"),require("js-cookie"),require("./frame-Oz7volks.js"),require("@privy-io/routes"),require("x402/client"),require("@privy-io/api-base"),require("viem/accounts"),require("./use-sign-with-user-signer-Cu_6Bx7m.js"),require("./getEmbeddedConnectedWallet-6TsVZJkD.js"),require("@heroicons/react/24/outline/DevicePhoneMobileIcon"),require("@heroicons/react/24/outline/FingerPrintIcon"),require("@heroicons/react/24/outline/PhoneIcon"),require("@heroicons/react/24/outline/ShieldCheckIcon"),require("./ModalHeader-C5O9gNUP.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("./ScreenLayout-BtVIYAso.js"),require("./Screen-BSwlHqPg.js"),require("./index-ByFhjjzH.js"),require("./PinInput-B12fA7pp.js"),require("@heroicons/react/24/outline/CalendarIcon"),require("@heroicons/react/24/outline/ExclamationTriangleIcon"),require("./StackedContainer-CM36po_U.js"),require("./useGetTokenPrice-DJpJnTij.js"),require("./useGetSolPrice-Ca32VAbF.js"),require("./TransactionDetails-DYow9ihU.js"),require("./WalletLink-CZLtiI7E.js"),require("./ethers-XrYC9HG-.js"),require("./getFormattedUsdFromLamports-Mu2fqwL2.js"),require("./transaction-DjF5X-by.js"),require("./Layouts-D3TOcPhm.js"),require("@heroicons/react/24/outline/ChevronDownIcon");const s=({onClose:s})=>{let{user:n}=t.usePrivyContext(),c=i.useAppConfig(),a=n?.mfaMethods.filter((e=>"passkey"!==e||!c.globalDisablePasskeys))??[],[l,q]=r.useState(a[0]??null),{init:d,cancel:h,submit:j}=o.useMfa(),[f,y]=r.useState(!1),[p,v]=r.useState(null),[m,k]=r.useState();r.useEffect((()=>{q(a[0]??null)}),[a]);let g=r.useRef(!1);async function S(e){k(void 0);try{if(!e||!l)return;await j(l,e),y(!0),k(void 0),s()}catch(e){throw u.toUIError(e).error}}async function w(e){if("passkey"!==e)try{q(e),await d(e)}catch(e){console.error(e)}else try{q(e);let r=await d(e);if(!r)throw Error("something went wrong");v(r),await j(e,r),y(!0),k(void 0),s()}catch(e){k(u.toUIError(e))}}r.useEffect((()=>{!g.current&&l&&(g.current=!0,w(l).finally((()=>{g.current=!1})))}),[]);let C=()=>{q(null),k(void 0),h(),s()};return n?"passkey"===l?/*#__PURE__*/e.jsx(u.VerifyWithPasskey,{account:n.linkedAccounts.filter((e=>"passkey"===e.type&&e.enrolledInMfa)).sort(((e,r)=>r.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf()))[0],submitSuccess:f,hasBlockingError:m?.isBlocking??!1,error:m?.error,onClose:C,onBack:()=>{q(null),k(void 0)},handleSubmit:()=>S(p).catch(k)}):l?/*#__PURE__*/e.jsx(u.VerifyWithSmsOrTotpCode,{submitSuccess:f,hasBlockingError:m?.isBlocking??!1,handleSubmitCode:S,selectedMethod:l,onClose:C,onBack:a.length>1?()=>q(null):void 0}):/*#__PURE__*/e.jsx(u.VerifyMethodSelectionScreen,{mfaMethods:a,onSelect:w,handleClose:C}):null};exports.MfaVerifyFlowScreen=s,exports.default=s;
