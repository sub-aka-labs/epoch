"use strict";var e=require("react/jsx-runtime"),r=require("react"),i=require("./context-BeSQM-Ma.js"),t=require("./index-CzmnSRoa.js"),s=require("./internal-context-BJv4f_bO.js"),o=require("./get-is-unified-wallet-BwdzQwn_.js"),a=require("./SetWalletPasswordForm-Gkq-DskE.js");require("@privy-io/js-sdk-core"),require("tinycolor2"),require("uuid"),require("jose"),require("eventemitter3"),require("./useActiveWallet-vlXeDPzp.js"),require("zustand"),require("styled-components"),require("react-device-detect"),require("./prepareFundingModalData-DDf6xLze.js"),require("./events-context-Di6--rDg.js"),require("viem"),require("viem/utils"),require("./getPublicClient-BsmZyCGX.js"),require("./useWallets-DMyuB5aJ.js"),require("@coinbase/wallet-sdk"),require("@privy-io/ethereum"),require("mipd"),require("@privy-io/popup"),require("./paths-DizMb-lU.js"),require("./usePrivy-Bx2PKTrU.js"),require("@scure/base"),require("@headlessui/react"),require("@walletconnect/ethereum-provider"),require("@privy-io/urls"),require("ofetch"),require("js-cookie"),require("./frame-Oz7volks.js"),require("@privy-io/routes"),require("x402/client"),require("@privy-io/api-base"),require("viem/accounts"),require("./use-sign-with-user-signer-Cu_6Bx7m.js"),require("./getEmbeddedConnectedWallet-6TsVZJkD.js"),require("@heroicons/react/24/outline/ExclamationTriangleIcon"),require("./Layouts-D3TOcPhm.js"),require("./ModalHeader-C5O9gNUP.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("./shared-BcueHfN-.js"),require("@heroicons/react/24/outline/ArrowPathIcon"),require("@heroicons/react/24/outline/EyeIcon"),require("@heroicons/react/24/outline/EyeSlashIcon"),require("./Checkbox-DzxHC5tk.js"),require("@heroicons/react/24/outline/KeyIcon"),require("@heroicons/react/24/solid/CheckCircleIcon"),require("fast-password-entropy"),require("secure-password-utilities"),require("secure-password-utilities/wordlists"),require("@heroicons/react/24/outline/ArrowDownTrayIcon"),require("@heroicons/react/24/outline/ClipboardDocumentCheckIcon"),require("@heroicons/react/24/outline/DocumentDuplicateIcon"),require("@heroicons/react/24/solid/XCircleIcon"),require("./ScreenHeader-CgYJ5Fmg.js");const u={component:()=>{let{navigate:u,data:n,onUserCloseViaDialogOrKeybindRef:c}=o.usePrivyModal(),l=i.useAppConfig(),[d,q]=r.useState(""),[h,w]=r.useState(!1),[p,y]=r.useState(),[v,m]=r.useState(null),{create:f}=t.useCreateWalletWithoutFallback(),{authenticated:j,user:C}=o.usePrivyContext(),{closePrivyModal:P,isNewUserThisSession:S,initializeWalletProxy:g}=s.usePrivyInternal(),{onSuccess:b,onFailure:I,callAuthOnSuccessOnClose:x,shouldCreateEth:E,shouldCreateSol:W}=n.createWallet,[A,M]=r.useState(null),k=new t.RunEffectOnce((async()=>{try{let e;if(E&&W)e=await f({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C}),e=await f({chainType:"solana",walletIndex:0,latestUser:e.user});else if(W)e=await f({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"solana",walletIndex:0,latestUser:C});else{if(!E)throw Error("Invalid args to create wallet");e=await f({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C})}M(e),S?u("EmbeddedWalletCreatedScreen"):(b(e),P({shouldCallAuthOnSuccess:x}))}catch(e){q(e.message)}}));r.useEffect((()=>{v||g(3e4).then((e=>m(e)))}),[v]),r.useEffect((()=>{if(!j||!C)return u("LandingScreen"),void I(Error("User must be authenticated before creating a Privy wallet"))}),[j]),c.current=()=>null;/*#__PURE__*/return e.jsx(a.SetWalletPasswordForm,{config:{initiatedBy:"automatic"},appName:l?.name||"privy",loading:!v,buttonLoading:h,buttonHideAnimations:!A&&h,isResettingPassword:!1,error:d,password:p||"",onClose:()=>{A&&"user-passcode"!==A.account.recoveryMethod?(I(new s.PrivyEmbeddedWalletError("User created a wallet but failed to set a password for it")),P({shouldCallAuthOnSuccess:!1})):A?(b(A),P({shouldCallAuthOnSuccess:x})):(I(new s.PrivyEmbeddedWalletError("User wallet creation failed")),P({shouldCallAuthOnSuccess:!1}))},onPasswordChange:y,onPasswordGenerate:()=>y(a.generatePassphrase()),onSubmit:async()=>(w(!0),k.execute().then((()=>new Promise((e=>setTimeout(e,250))))).finally((()=>w(!1))))})}};exports.EmbeddedWalletPasswordCreateScreen=u,exports.default=u;
