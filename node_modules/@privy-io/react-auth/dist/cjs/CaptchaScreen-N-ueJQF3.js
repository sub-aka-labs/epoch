"use strict";var e=require("react/jsx-runtime"),r=require("lucide-react"),t=require("react"),i=require("./index-CzmnSRoa.js"),u=require("./get-is-unified-wallet-BwdzQwn_.js"),s=require("./ScreenLayout-BtVIYAso.js");require("@privy-io/js-sdk-core"),require("uuid"),require("jose"),require("eventemitter3"),require("./useActiveWallet-vlXeDPzp.js"),require("zustand"),require("./context-BeSQM-Ma.js"),require("tinycolor2"),require("styled-components"),require("react-device-detect"),require("./prepareFundingModalData-DDf6xLze.js"),require("./internal-context-BJv4f_bO.js"),require("ofetch"),require("./events-context-Di6--rDg.js"),require("viem"),require("viem/utils"),require("./getPublicClient-BsmZyCGX.js"),require("./useWallets-DMyuB5aJ.js"),require("@coinbase/wallet-sdk"),require("@privy-io/ethereum"),require("mipd"),require("@privy-io/popup"),require("./paths-DizMb-lU.js"),require("./usePrivy-Bx2PKTrU.js"),require("@scure/base"),require("@headlessui/react"),require("@walletconnect/ethereum-provider"),require("@privy-io/urls"),require("js-cookie"),require("./frame-Oz7volks.js"),require("@privy-io/routes"),require("x402/client"),require("@privy-io/api-base"),require("viem/accounts"),require("./use-sign-with-user-signer-Cu_6Bx7m.js"),require("./getEmbeddedConnectedWallet-6TsVZJkD.js"),require("./ModalHeader-C5O9gNUP.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("./Screen-BSwlHqPg.js"),require("./index-ByFhjjzH.js");const a=({status:i,title:u,description:a,userIntentRequired:n,retriesRemaining:c,hasSelectedCta:o,onContinue:l,onRetry:d})=>{let q=t.useMemo((()=>{switch(i){case"loading":default:return;case"success":return n?{label:o?"Continuing...":"Continue",onClick:l,disabled:o,loading:o}:void 0;case"error":return c>0?{label:"Retry",onClick:d}:void 0}}),[i,o,l,d]),p=t.useMemo((()=>({loading:"loading",ready:"subtle",disabled:"subtle",success:"success",error:"error"}[i]||"loading")),[i]);/*#__PURE__*/return e.jsx(s.ScreenLayout,{icon:"loading"===i||"ready"===i?void 0:"success"===i?r.CheckCircle:r.XCircle,iconVariant:p,title:u,subtitle:a,primaryCta:q,watermark:!0})},n={component:()=>{let{lastScreen:r,data:s,navigate:n,setModalData:c}=u.usePrivyModal(),{status:o,token:l,waitForResult:d,reset:q,execute:p}=i.useCaptcha(),h=t.useRef([]),y=e=>{h.current=[e,...h.current]},[g,m]=t.useState(!0);t.useEffect((()=>(y(setTimeout(m,1e3,!1)),()=>{h.current.forEach((e=>clearTimeout(e))),h.current=[]})),[]);let[C,v]=t.useState(""),[j,f]=t.useState("Checking that you are a human..."),[S,b]=t.useState(!1),[k,w]=t.useState(3),R=s?.captchaModalData,x=async e=>{try{await(R?.callback(e)),R?.onSuccessNavigateTo&&n(R?.onSuccessNavigateTo,!1)}catch(e){if(e instanceof i.CaptchaError)return;c({errorModalData:{error:e,previousScreen:r||"LandingScreen"}}),n(R?.onErrorNavigateTo||"ErrorScreen",!1)}};t.useEffect((()=>{"success"===o?y(setTimeout((async()=>{let e=await d();!e||R?.userIntentRequired||x(e)}),1e3)):"ready"===o&&y(setTimeout((()=>{"ready"===o&&p()}),500))}),[o]),t.useEffect((()=>{if(!g)switch(o){case"success":v("Success!"),f("CAPTCHA passed successfully."),R?.userIntentRequired||setTimeout((()=>{b(!0),x(l)}),2e3);break;case"loading":v(""),f("Checking that you are a human...");break;case"error":v("Something went wrong"),f(k<=0?"If you use an adblocker or VPN, try disabling and re-attempting.":"You did not pass CAPTCHA. Please try again.")}}),[o,g,S]);/*#__PURE__*/return e.jsx(a,{status:o,title:C,description:j,userIntentRequired:R?.userIntentRequired,retriesRemaining:k,hasSelectedCta:S,onContinue:()=>{b(!0),x(l)},onRetry:async()=>{if(k<=0)return;w((e=>e-1)),q(),p();let e=await d();!e||R?.userIntentRequired||x(e)}})}};exports.CaptchaScreen=n,exports.CaptchaScreenView=a,exports.default=n;
