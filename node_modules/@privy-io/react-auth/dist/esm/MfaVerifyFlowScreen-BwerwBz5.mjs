import{jsx as o}from"react/jsx-runtime";import{useState as t,useEffect as e,useRef as r}from"react";import{u as i}from"./context-LVpDfP2H.mjs";import{u as s}from"./get-is-unified-wallet-CNcx75Dp.mjs";import{u as n}from"./index-DNz_w3-G.mjs";import{V as m,a as c,b as a,t as l}from"./to-ui-error-CCqAdorW.mjs";import"@privy-io/js-sdk-core";import"tinycolor2";import"viem";import"./internal-context-Z-fyxadS.mjs";import"ofetch";import"uuid";import"jose";import"eventemitter3";import"./useActiveWallet-RZ4w-uGq.mjs";import"zustand";import"styled-components";import"react-device-detect";import"./prepareFundingModalData-DjTxAoJ1.mjs";import"./events-context-CI0iqAXA.mjs";import"viem/utils";import"./getPublicClient-B4uPLKn-.mjs";import"./useWallets-DlGuNtGR.mjs";import"@coinbase/wallet-sdk";import"@privy-io/ethereum";import"mipd";import"@privy-io/popup";import"./paths-3HW55qZg.mjs";import"./usePrivy-Dj52a5sp.mjs";import"@scure/base";import"@headlessui/react";import"@walletconnect/ethereum-provider";import"@privy-io/urls";import"js-cookie";import"./frame-uzTmvtww.mjs";import"@privy-io/routes";import"x402/client";import"@privy-io/api-base";import"viem/accounts";import"./use-sign-with-user-signer-Do5Oi_rb.mjs";import"./getEmbeddedConnectedWallet-CM6cDQCS.mjs";import"@heroicons/react/24/outline/DevicePhoneMobileIcon";import"@heroicons/react/24/outline/FingerPrintIcon";import"@heroicons/react/24/outline/PhoneIcon";import"@heroicons/react/24/outline/ShieldCheckIcon";import"./ModalHeader-rCMpqA2a.mjs";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"./ScreenLayout-DF3DCKOK.mjs";import"./Screen-CV2tt2Ap.mjs";import"./index-Dq_xe9dz.mjs";import"./PinInput-3SLvbnQa.mjs";import"@heroicons/react/24/outline/CalendarIcon";import"@heroicons/react/24/outline/ExclamationTriangleIcon";import"./StackedContainer-B2vaEl56.mjs";import"./useGetTokenPrice-DERdsrmf.mjs";import"./useGetSolPrice-DwwjjGbd.mjs";import"./TransactionDetails-BP142O9n.mjs";import"./WalletLink-CN4enmsE.mjs";import"./ethers-BQ45eiVv.mjs";import"./getFormattedUsdFromLamports-B6EqSEho.mjs";import"./transaction-CnfuREWo.mjs";import"./Layouts-BlFm53ED.mjs";import"@heroicons/react/24/outline/ChevronDownIcon";const p=({onClose:p})=>{let{user:u}=s(),d=i(),h=u?.mfaMethods.filter((o=>"passkey"!==o||!d.globalDisablePasskeys))??[],[j,f]=t(h[0]??null),{init:v,cancel:y,submit:k}=n(),[g,b]=t(!1),[w,I]=t(null),[C,S]=t();e((()=>{f(h[0]??null)}),[h]);let M=r(!1);async function P(o){S(void 0);try{if(!o||!j)return;await k(j,o),b(!0),S(void 0),p()}catch(o){throw l(o).error}}async function x(o){if("passkey"!==o)try{f(o),await v(o)}catch(o){console.error(o)}else try{f(o);let t=await v(o);if(!t)throw Error("something went wrong");I(t),await k(o,t),b(!0),S(void 0),p()}catch(o){S(l(o))}}e((()=>{!M.current&&j&&(M.current=!0,x(j).finally((()=>{M.current=!1})))}),[]);let B=()=>{f(null),S(void 0),y(),p()};return u?"passkey"===j?/*#__PURE__*/o(m,{account:u.linkedAccounts.filter((o=>"passkey"===o.type&&o.enrolledInMfa)).sort(((o,t)=>t.firstVerifiedAt.valueOf()-o.firstVerifiedAt.valueOf()))[0],submitSuccess:g,hasBlockingError:C?.isBlocking??!1,error:C?.error,onClose:B,onBack:()=>{f(null),S(void 0)},handleSubmit:()=>P(w).catch(S)}):j?/*#__PURE__*/o(c,{submitSuccess:g,hasBlockingError:C?.isBlocking??!1,handleSubmitCode:P,selectedMethod:j,onClose:B,onBack:h.length>1?()=>f(null):void 0}):/*#__PURE__*/o(a,{mfaMethods:h,onSelect:x,handleClose:B}):null};export{p as MfaVerifyFlowScreen,p as default};
